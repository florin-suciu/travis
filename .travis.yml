language: python
python:
  - "3.6"
install:
  - pip install -r requirements.txt
script:
  - pytest --html=reports/report.html --self-contained-html
after_script:
  - if [[ "$TRAVIS_TEST_RESULT" == 0 ]]; then TEST_MESSAGE="Tests passed -"; else TEST_MESSAGE="Tests failed -"; fi
  - TEST_REPORT_DOWNLOAD_URL=$(python tests/utils/gdrive/upload_test_report.py)
  - echo $TEST_REPORT_DOWNLOAD_URL
  - python tests/utils/gdrive/comment.py $AUTH_KEY $TRAVIS_REPO_SLUG $TRAVIS_PULL_REQUEST "$TEST_MESSAGE $TEST_REPORT_DOWNLOAD_URL"
